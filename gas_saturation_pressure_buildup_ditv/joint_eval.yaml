###############################################################################
# Joint Autoregressive Evaluation Config (COâ‚‚ Gas + Pressure) (2025)
#
# Author: Vittoria De Pellegrini
# Affiliation: PhD Student, King Abdullah University of Science and Technology
#
# Description: Evaluation configuration for running deterministic autoregressive
#              rollouts and computing metrics on the held-out validation set.
###############################################################################

# Dataset Parameters
dataset_params:
  num_images_train: 0
  frame_height: 96
  frame_width: 200
  frame_channels: 1
  num_frames: 17
  autoregressive:
    context_frames: 15
    predict_frames: 2
    window_stride: 1
    drop_incomplete: false
  stats_paths:
    gas: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/co2_data/training_dataset_gas_saturation/sg_train_min_max.pt
    pressure: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/dP_data/training_dataset_pressure_buildup/dP_train_min_max.pt
  file_map:
    train: null
    val:
      gas: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/co2_data_evaluation/val_sg_target.pt
      pressure: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/dP_data_evaluation/val_dP_target.pt
    test: null

# Diffusion Parameters
diffusion_params:
  num_timesteps: 1000

# Rectified flow scheduler parameters
rf_params:
  num_sampling_steps: 30
  sample_method: 'uniform'
  use_discrete_timesteps: false
  use_timestep_transform: false
  transform_scale: 1.0
  pa_vdm: false
  noise_pattern: 'linear'
  linear_variance_scale: 0.1
  linear_shift_scale: 0.3
  latent_chunk_size: 1
  keep_x0: false
  variable_length: false

# DiT video diffusion Parameters
ditv_params:
  patch_size: 2
  num_layers: 8
  hidden_size: 512
  num_heads: 8
  head_dim: 64
  timestep_emb_dim: 256

autoencoder_params:
  gas:
    type: vqvae
    z_channels: 2
    codebook_size: 16384
    down_channels: [256, 384, 512, 1024]
    mid_channels: [1024, 1024]
    down_sample: [true, true, true]
    attns: [false, false, false]
    norm_channels: 32
    num_heads: 4
    num_down_layers: 2
    num_mid_layers: 2
    num_up_layers: 2
    ckpt_path: /.../LAViG-FLOW/gas_saturation_vqvae/trained_models/vqvae_model.pth
  pressure:
    type: vae
    z_channels: 24
    down_channels: [32, 64, 128, 128]
    mid_channels: [128, 128]
    down_sample: [true, true, true]
    attns: [false, false, false]
    norm_channels: 16
    num_heads: 4
    num_down_layers: 1
    num_mid_layers: 1
    num_up_layers: 1
    ckpt_path: /.../LAViG-FLOW/pressure_buildup_vae/trained_models/vae_model.pth

# Training / checkpoint references
train_params:
  ditv_ckpt_name: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/trained_models/joint_dit_autoreg.pth
  ditv_ckpt_complete_name: /.../LAViG-FLOW/gas_saturation_pressure_buildup_ditv/trained_models/joint_dit_autoreg_full.pth